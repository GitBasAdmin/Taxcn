
<div style="float: left;margin-left:3px;margin-top:3px;"><b>>ผู้ชำระค่าปรับ</b></div>
    <table datatable [dtOptions]="dtOptions1" [dtTrigger]="dtTrigger_1"  class="table table-striped table-bordered table-sm row-border hover" style="width:60%;" align="center">
        <thead>
            <tr>
                <th width="10%" class="no-sort">ลำดับที่</th>
                <th width="10%" class="no-sort">คำนำหน้า</th>
                <th width="80%" class="no-sort">ชื่อ/ชื่อสกุลผู้ชำระค่าปรับ</th>
            </tr>
        </thead>
        <tbody *ngIf="GuarantorDataObj?.length != 0">
            <tr *ngFor="let post of GuarantorDataObj;let i = index;" >
                <td align="center" width="10%" >{{post.guarman_item}}</td>
                <td align="center" width="10%">{{post.guar_title}}</td>
                <td align="center" width="80%">{{post.guar_name}}</td>
                </tr>
        </tbody>
        <tbody *ngIf="GuarantorDataObj?.length == 0">
            <tr >
                <td colspan="3" style="color:red;text-align: center;" class="no-data-available">###### ไม่พบข้อมูล #######</td>
                <td style="display:none;"></td>
                <td style="display:none;"></td>
            </tr>
        </tbody>
    </table>
    <hr>
    <table style="width: 100%;margin-top:10px;">
        <tr>
            <td style="padding-left:10px;text-align: left;">
                <div style="float: left;margin-left:3px;margin-top:3px;"><b>> ปรับครั้งที่</b>
                    <span align="center" *ngFor="let item of getForfeit;let i = index;" style="margin-left: 4px;">
                        <label *ngIf="i!=0" style="font-size: 18px;font-weight: normal;">&nbsp;,&nbsp;</label>
                        <label style="cursor:pointer;color:blue;font-weight: normal;" (click)="editData(i)">{{item.forfeit_seq}} </label>
                    </span>
                </div>
            </td>
        </tr>
            <tr>
                <td>
                    <table style="width: 100%;margin-top:10px;">
                        <tr>
                            <td align="right" style="width: 10%;">ครั้งที่	:&nbsp;</td>
                            <td align="left" style="width: 20%;">
                                <div style="float: left;">
                                    <input  type="text" [(ngModel)]="result.forfeit_seq" class="form-control" (click)="runForfeitSeq()" style="width:60px;"/>
                                </div>
                                <div style="float: left;">
                                    <button type="button" class="btn btn-primary" style="margin-left:4px;" (click)="getForfeitDetail(2)">ค้นหา</button>
                                </div>
                                <div style="float: left;" *ngIf="result.edit_forfeit_seq">
                                    <button type="button" class="btn btn-danger" style="margin-left:5px;" (click)="deleteForfeitData ()">ลบข้อมูลการปรับ</button>
                                </div>
                            </td>
                            <td align="right" style="width: 10%;">ผู้ถูกประกัน	:&nbsp;</td>
                            <td align="left" style="width: 60%;" colspan="3">
                                <div style="float: left;">
                                    <input  type="text" [(ngModel)]="result.def_name" readonly class="form-control" style="width:320px;"/>
                                </div>
                                <div style="float: left;margin-left: 4px;">
                                    <i  class="far fa-list-alt" style="font-size: 20px;margin-left:2px;margin-top:1px;" (click)="clickOpenMyModalComponent(1)"></i>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td align="right" >ค่าปรับ	:&nbsp;</td>
                            <td align="left" >
                                <div style="float: left;">
                                    <input  type="text" [(ngModel)]="result.forfeit_amt" value="0.00" class="form-control" style="width:100px;"/>
                                </div>
                                <div style="float: left;margin-left: 2px;">บาท</div>
                            </td>
                            <td align="right" style="width: 10%;">ลดเหลือ	:&nbsp;</td>
                            <td align="left" style="width: 20%;">
                                <div style="float: left;">
                                    <input  type="text" [(ngModel)]="result.discount_amt" value="0.00" class="form-control" style="width:100px;"/>
                                </div>
                                <div style="float: left;margin-left: 2px;">บาท</div>
                            </td>
                            <td align="right" style="width: 10%;">ชำระแล้ว	:&nbsp;</td>
                            <td align="left" style="width: 20%;">
                                <div style="float: left;">
                                    <input  type="text" [(ngModel)]="result.paid_amt" value="0.00" class="form-control" style="width:100px;"/>
                                </div>
                                <div style="float: left;margin-left: 2px;">บาท</div>
                            </td>
                        </tr>
                        <tr>
                            <td align="right" >วันที่สั่งปรับ	:&nbsp;</td>
                            <td align="left" >
                                <div style="float:left;">
                                    <input  type="text" [(ngModel)]="result.forfeit_date" style="width:100px;text-align:left;" class="form-control jcalendar forfeit_date" #forfeitDate (click)="directiveDate(forfeitDate.value,'forfeit_date')">
                                </div>
                                <div style="float:left;margin-left:8px;margin-top:5px;">
                                    <i class="fa fa-calendar" style="font-size: 16px;" onClick="$('.forfeit_date').focus();"></i>
                                </div>
                            </td>
                            <td align="right" >วันที่สั่งลด	:&nbsp;</td>
                            <td align="left" >
                                <div style="float:left;">
                                    <input  type="text" [(ngModel)]="result.discount_date" style="width:100px;text-align:left;" class="form-control jcalendar discount_date" #discountDate (click)="directiveDate(discountDate.value,'discount_date')">
                                </div>
                                <div style="float:left;margin-left:8px;margin-top:5px;">
                                    <i class="fa fa-calendar" style="font-size: 16px;" onClick="$('.discount_date').focus();"></i>
                                </div>
                            </td>
                            <td align="right" style="width: 10%;">ภายใน 	:&nbsp;</td>
                            <td align="left" style="width: 20%;">
                                <div style="float: left;">
                                    <input  type="text" [(ngModel)]="result.due_forfeit" class="form-control" style="width:100px;"/>
                                </div>
                                <div style="float: left;margin-left: 2px;">วัน</div>
                            </td>
                        </tr>
                        <tr>
                            <td align="right" >ปรับตั้งแต่วันที่	:&nbsp;</td>
                            <td align="left" >
                                <div style="float:left;">
                                    <input  type="text" [(ngModel)]="result.start_date" style="width:100px;text-align:left;" class="form-control jcalendar start_date" #startDate (click)="directiveDate(startDate.value,'start_date')">
                                </div>
                                <div style="float:left;margin-left:8px;margin-top:5px;">
                                    <i class="fa fa-calendar" style="font-size: 16px;" onClick="$('.start_date').focus();"></i>
                                </div>
                            </td>
                            <td align="right" >แจ้งคำสั่งศาลโดย	:&nbsp;</td>
                            <td align="left" >
                                <div style="float:left;">
                                    <ng-select [(ngModel)]="result.notice_by" [clearable]="false" style="width:110%;min-width:170px;" >
                                        <ng-option *ngFor="let getData of getNoticeBy"  [value]=getData.fieldIdValue >{{getData.fieldNameValue}}</ng-option>
                                    </ng-select>
                                </div>                                            
                            </td>
                            <td align="right" style="width: 20%;">วันที่ครบกำหนดชำระ 	:&nbsp;</td>
                            <td align="left" style="width: 20%;">
                                <div style="float:left;">
                                    <input  type="text" [(ngModel)]="result.due_date" style="width:100px;text-align:left;" class="form-control jcalendar due_date" #dueDate (click)="directiveDate(dueDate.value,'due_date')">
                                </div>
                                <div style="float:left;margin-left:8px;margin-top:5px;">
                                    <i class="fa fa-calendar" style="font-size: 16px;" onClick="$('.due_date').focus();"></i>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td align="right" valign="top" >ประเภทการชำระ	:&nbsp;</td>
                            <td align="left"  valign="top" >
                                <div style="float:left;">
                                    <ng-select [(ngModel)]="result.pay_type" [clearable]="false" style="width:110%;min-width:170px;" (click)="getCalendar()" >
                                        <ng-option *ngFor="let getData of getPayType"  [value]=getData.fieldIdValue >{{getData.fieldNameValue}}</ng-option>
                                    </ng-select>
                                </div>   
                            </td>
                            <td align="right"></td>
                            <td align="left" valign="top">
                                <div style="float:left;">
                                    <input type="checkbox" name="all" [(ngModel)]="result.refrain_flag" value="1" (change)="setDate()" />
                                </div>
                                <div style="float:left;margin-left: 2px;"><span style="color: red;">งดปรับ    วันที่บันทึกงดปรับ</span></div>    
                                <div style="float: left;margin-left: 2px;">
                                    <input  type="text" [(ngModel)]="result.create_refrain_date" readonly class="form-control" style="width:100px;"/>
                                </div>                                        
                            </td>
                            <td align="left" colspan="2" [ngStyle]="result.pay_type==2 ?  {'display': ''} : {'display': 'none'}" >
                               <table>
                                    <tr>
                                        <td  width="5%"><input type="radio" [(ngModel)]="result.ptype" name="ptype" [value]="1" (change)="clickPayTime()" style="width:15px;height:15px;margin-top:5px;"></td>
                                        <td  width="15%">เดือนละ</td>
                                        <td  width="80%">
                                            <table>
                                                <tr [ngStyle]="result.ptype==1 ?  {'display': ''} : {'display': 'none'}">
                                                    <td>
                                                        <div style="float:left;"><input type="radio" [(ngModel)]="result.pay_time" name="pay_time" [value]="1" style="width:15px;height:15px;margin-top:2px;"></div>
                                                        <div style="float:left;margin-left: 4px;">1</div>
                                                        <div style="float:left;margin-left: 8px;"><input type="radio" [(ngModel)]="result.pay_time" name="pay_time" [value]="2" style="width:15px;height:15px;margin-top:2px;"></div>
                                                        <div style="float:left;margin-left: 8px;">2 ครั้ง</div>
                                                        <div style="float:left;margin-left: 2px;">ทุกวันที่</div>
                                                        <div style="float:left;margin-left: 2px;"><input  type="text" [(ngModel)]="result.pay_dd1" class="form-control" style="width:25px;"/></div>                                    
                                                        <div style="float:left;margin-left: 2px;" [ngStyle]="result.pay_time==2 ?  {'display': ''} : {'display': 'none'}">,</div>
                                                        <div style="float:left;margin-left: 2px;" [ngStyle]="result.pay_time==2 ?  {'display': ''} : {'display': 'none'}"><input  type="text" [(ngModel)]="result.pay_dd2" class="form-control" style="width:25px;"/></div>                                    
                                                        <div style="float:left;margin-left: 2px;">ของเดือน เริ่มชำระวันที่ </div>
                                                        <div style="float:left;margin-left: 2px;">
                                                            <input  type="text" [(ngModel)]="result.start_due" style="width:100px;text-align:left;" class="form-control jcalendar start_due" #startDue (click)="directiveDate(startDue.value,'start_due')">
                                                        </div>
                                                        <div style="float:left;margin-left:8px;margin-top:5px;">
                                                            <i class="fa fa-calendar" style="font-size: 16px;" onClick="$('.start_due').focus();"></i>
                                                        </div>                                                                                      
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td  width="5%"><input type="radio" [(ngModel)]="result.ptype" name="ptype" [value]="2" style="width:15px;height:15px;margin-top:5px;" ></td>
                                        <td  width="15%">ทุก 6 เดือน	</td>
                                        <td  width="80%">
                                            <table>
                                                <tr [ngStyle]="result.ptype==2 ?  {'display': ''} : {'display': 'none'}">
                                                    <td>
                                                        <div style="float:left;">เริ่มตั้งแต่เดือน</div>
                                                        <div style="float:left;margin-left: 2px;">
                                                            <ng-select [(ngModel)]="result.month1" [clearable]="false" style="width:110%;min-width:100px;" >
                                                                <ng-option *ngFor="let getData of getMonth"  [value]=getData.fieldIdValue >{{getData.fieldNameValue}}</ng-option>
                                                            </ng-select>
                                                        </div> 
                                                        <div style="float:left;margin-left: 14px;">
                                                            <ng-select [(ngModel)]="result.year1" [clearable]="false" style="width:110%;min-width:100px;" >
                                                                <ng-option *ngFor="let getData of getYear"  [value]=getData.fieldIdValue >{{getData.fieldNameValue}}</ng-option>
                                                            </ng-select>
                                                        </div>                                                                        
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td  width="5%"><input type="radio" [(ngModel)]="result.ptype" name="ptype" [value]="3" style="width:15px;height:15px;margin-top:5px;" ></td>
                                        <td  width="15%">ปีละ 1 ครั้ง	</td>
                                        <td  width="80%">
                                            <table>
                                                <tr [ngStyle]="result.ptype==3 ?  {'display': ''} : {'display': 'none'}">
                                                    <td>
                                                        <div style="float:left;">เริ่มตั้งแต่เดือน</div>
                                                        <div style="float:left;margin-left: 2px;">
                                                            <ng-select [(ngModel)]="result.month2" [clearable]="false" style="width:110%;min-width:100px;" >
                                                                <ng-option *ngFor="let getData of getMonth"  [value]=getData.fieldIdValue >{{getData.fieldNameValue}}</ng-option>
                                                            </ng-select>
                                                        </div> 
                                                        <div style="float:left;margin-left: 14px;">
                                                            <ng-select [(ngModel)]="result.year2" [clearable]="false" style="width:110%;min-width:100px;" >
                                                                <ng-option *ngFor="let getData of getYear"  [value]=getData.fieldIdValue >{{getData.fieldNameValue}}</ng-option>
                                                            </ng-select>
                                                        </div>                                                                        
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td  width="5%">
                                            <input type="radio" [(ngModel)]="result.ptype" name="ptype" [value]="4" style="width:15px;height:15px;margin-top:5px;" >
                                        </td>
                                        <td  width="15%">อื่น ๆ	</td>
                                        <td  width="80%">
                                            <table>
                                                <tr>
                                                    <td>
                                                        <div style="float:left;"><input  type="text" [(ngModel)]="result.other_detail" style="width:180px;text-align:center;" class="form-control"></div>                                                                                    
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td  width="5%"></td>
                                        <td  width="15%">ชำระงวดละ</td>
                                        <td  width="80%">
                                            <table>
                                                <tr>
                                                    <td>
                                                        <div style="float:left;"><input  type="text" [(ngModel)]="result.amt_time" style="width:120px;" class="form-control"></div>     
                                                        <div style="float:left;margin-left: 2px;">บาท </div>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                               </table>                                      
                            </td>
                        </tr>
                        <tr>
                            <td align="right" >หมายเหตุ	:&nbsp;</td>
                            <td align="left" colspan="5">
                                <div style="float:left;">
                                    <input  type="text" [(ngModel)]="result.remark" class="form-control" style="width:650px;"/>
                                </div>   
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        <tr>
            <td>
                <div style="margin-top: 5px;text-align:center;padding-bottom: 5px;">
                    <button type="button" class="btn btn-success" style="margin-left:5px;" (click)="saveData()">จัดเก็บ</button>
                    <button type="button" class="btn btn-primary" style="margin-left:5px;" (click)="newData()" >เพิ่ม</button>
                    <!-- <button type="button" class="btn btn-primary" style="margin-left:5px;">ส่งข้อมุลให้ระบบบังคับคดี</button> --><!--พี่ต้อมบอกว่าซ่อนไปก่อนยังไม่มีหรอก-->
                    <button type="button" class="btn btn-danger" style="margin-left:5px;" (click)="deleteData()" >ลบข้อมูลที่เลือก</button>
                    <button type="button" class="btn btn-primary" style="margin-left:5px;"*ngIf="result.edit_forfeit_seq !=0"  (click)="selectReceipt()" >เลือกข้อมูลใบเสร็จ</button>
                    <button type="button" class="btn btn-warning" style="margin-left:5px;" (click)="ClearAll()">ยกเลิก</button>
                </div>
            </td>
        </tr>
        <tr>
            <td style="padding-left:10px;text-align: left;">
                <table datatable [dtOptions]="dtOptions2" [dtTrigger]="dtTrigger_2"  class="table table-striped table-bordered table-sm row-border hover" style="width:90.5%;" align="center">
                    <thead>
                        <tr align="center">
                            <th width="33" class="no-sort"><input type="checkbox" name="all" [(ngModel)]="masterSelected" value="m1" (change)="checkUncheckAll()"/></th>
                            <th width="149" class="no-sort">งวดที่</th>
                            <th width="70" class="no-sort">วันที่ชำระ</th>
                            <th width="153" class="no-sort">เล่มที่</th>
                            <th width="112" class="no-sort">เลขที่ใบเสร็จ</th>
                            <th width="254" class="no-sort">จำนวนเงินที่ชำระ/งวด</th>
                            <th width="99" class="no-sort">ค่าปรับคงเหลือ</th>
                        </tr>
                    </thead>
                    <tbody *ngIf="AppealReqData?.length != 0">
                        <tr *ngFor="let post of AppealReqData;let i = index;" >
                            <td align="center"><input type="checkbox"  [(ngModel)]="AppealReqData[i].edit0100" (change)="isAllSelected()" ></td>
                            <td align="center">{{post.time_send}}</td>
                            <td align="center">{{post.rcv_date}}</td>
                            <td align="center">({{post.book_no}})</td>
                            <td align="center">{{post.rreceipt_no}}</td>
                            <td align="center">{{post.sum_fee}}</td>
                            <td align="center">{{post.remain_amt}}</td>
                        </tr>
                    </tbody>
                    <tbody *ngIf="AppealReqData?.length == 0">
                        <tr>
                            <td colspan="7" style="color:red;text-align: center;" class="no-data-available">###### ไม่พบข้อมูล #######</td>
                            <td style="display:none;"></td>
                            <td style="display:none;"></td>
                            <td style="display:none;"></td>
                            <td style="display:none;"></td>

                            <td style="display:none;"></td>
                            <td style="display:none;"></td>
                        </tr>
                    </tbody>
                </table>
            </td>
        </tr>
    </table>

    <div class="modal fade" data-refresh="true"  role="dialog" id="exampleModal3" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" style="width:100%;height:100%;">
        <div class="modal-dialog">
            <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-danger" id="exampleModalLabel"></h5>
                <button type="button" #closebutton class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="closeModal()"></button>
                <button type="button" class="btn btn-warning" style="display:none;" data-bs-toggle="modal" data-bs-target="#exampleModal3" (click)="loadMyModalComponent();" #openbutton></button>
            </div>
            <div class="modal-body" >
                <div style="min-height: 100px;max-height: 480px;overflow: auto;">
                    <app-modal-confirm *ngIf="loadModalConfComponent" class="modal_app"></app-modal-confirm>
                    <app-popup-guardef *ngIf="loadPopupGuardefComponent" [guar_running]="guar_running" [types]=1 (onClickList)="receiveGuarGefData($event)" class="modal_app"></app-popup-guardef>
                    <app-popup-map-receipt *ngIf="loadPopupMapReceiptComponent" [run_id]="run_id" [guar_running]="guar_running" [forfeit_seq]="result.forfeit_seq" (onClickList)="receiveMapReceiptData($event)" class="modal_app"></app-popup-map-receipt>                    
                </div>
            </div>
            <div class="modal-footer">
                <button type="button"  class="btn btn btn-primary" (click)="submitModalForm()" *ngIf="loadModalConfComponent">ตกลง</button>
                <button type="button"  class="btn btn-warning" data-bs-dismiss="modal" (click)="closeModal()">ปิดหน้าจอ</button>
            </div>
            </div>
        </div>
    </div>

<!--<script src="case-type.component.js"></script>-->
<ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" type="ball-spin-clockwise">
    <p style="color: gray">Please Wait. </p>
</ngx-spinner>